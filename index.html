<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarTools - By Vallexian</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color, #2e2e2e);
            color: var(--text-color, #fff);
            overflow: hidden;
            transition: background-color 0.3s ease, background-image 0.3s ease;
        }
        body.with-background {
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .navbar {
            display: flex;
            align-items: center;
            background: var(--navbar-bg, linear-gradient(135deg, #1e1e1e, #444));
            height: 50px;
            padding: 0 15px;
            border-bottom: 1px solid #444;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            -webkit-app-region: drag; /* Make the navbar draggable */
        }
        .navbar .title {
            flex: 1;
            color: var(--text-color, #fff);
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            -webkit-app-region: drag; /* Prevent elements within the title from being draggable */
        }
        .navbar .title .version {
            font-size: 14px;
            color: #ccc;
            -webkit-app-region: drag; /* Prevent elements within the title from being draggable */
        }
        .navbar .home, .navbar .dropbtn, .navbar .settings-btn, .navbar .controls button {
            background: var(--button-bg, transparent);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color, #fff);
            padding: 5px 10px;
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
            border-radius: 8px;
            margin-left: 5px;
            -webkit-app-region: no-drag; /* Prevent buttons from being draggable */
        }
        .navbar .home:hover, .navbar .dropbtn:hover, .navbar .settings-btn:hover, .navbar .controls button:hover {
            background: var(--button-hover, rgba(255, 255, 255, 0.1));
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }
        .navbar .dropdown {
            position: relative;
            display: inline-block;
            -webkit-app-region: no-drag; /* Prevent dropdown from being draggable */
        }
        .navbar .dropdown .dropdown-content {
            display: none;
            position: absolute;
            background: rgba(46, 46, 46, 0.95);
            backdrop-filter: blur(5px);
            border: 1px solid #444;
            border-radius: 8px;
            min-width: 200px;
            top: 100%;
            left: 0;
            z-index: 1;
            animation: fadeIn 0.3s ease-in-out;
            padding: 5px 0;
        }
        .navbar .dropdown .dropdown-content a {
            color: var(--text-color, #fff);
            padding: 8px 15px;
            text-decoration: none;
            display: block;
            border-radius: 8px;
            -webkit-app-region: no-drag; /* Prevent links from being draggable */
        }
        .navbar .dropdown .dropdown-content a:hover {
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }
        .navbar .dropdown.active .dropdown-content {
            display: block;
        }
        .navbar .controls {
            display: flex;
            align-items: center;
            -webkit-app-region: no-drag; /* Prevent controls from being draggable */
        }
        .navbar .controls button {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            -webkit-app-region: no-drag; /* Prevent control buttons from being draggable */
        }
        .navbar .controls .close:hover {
            background: #810606;
        }
        #iframe-container {
            flex: 1;
            display: flex;
            position: relative;
            overflow: hidden;
            height: calc(100vh - 50px);
        }
        iframe {
            flex: 1;
            border: none;
            display: none; 
        }
        iframe.active {
            display: block; 
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #settings-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            z-index: 100;
            color: #fff;
            width: 300px;
            max-width: 100%;
            box-sizing: border-box;
        }
        #settings-panel h3 {
            margin-top: 0;
            font-size: 18px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        #settings-panel label {
            display: block;
            margin-bottom: 5px;
        }
        #settings-panel select, #settings-panel button {
            width: 100%;
            margin-bottom: 10px;
            -webkit-app-region: no-drag; /* Prevent settings panel elements from being draggable */
        }
        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 99;
            -webkit-app-region: no-drag; /* Prevent overlay from being draggable */
        }
    </style>
</head>
<body>
    <div id="overlay"></div>
    <div id="settings-panel">
        <h3>Customize Settings</h3>
        <label for="skin-select">Choose a Skin</label>
        <select id="skin-select" onchange="applySkin(this.value)">
            <option value="default">Default</option>
            <option value="light">Light Mode</option>
        </select>
        <label for="default-page">Default Page</label>
        <select id="default-page" onchange="setDefaultPage(this.value)">
            <option value="homepage">Homepage</option>
            <option value="iframe1">Ship Builder</option>
            <option value="iframe2">Item Finder</option>
            <option value="iframe3">Trading (UEX)</option>
            <option value="verseguide">Verseguide</option>
            <option value="arkmap">Planet Survey</option>
            <option value="iframe4">Mining (Regolith)</option>
            <option value="radio">Internet Radio</option>
            <option value="iframe5">SnarePlan</option>
        </select>
        <button onclick="toggleSettingsPanel()">Close</button>
    </div>
    <div class="navbar">
        <div class="title">
            <span>StarTools - Release 0.6.3</span>
        </div>
        
        <!-- Home Button -->
        <div class="dropdown">
            <button class="home" onclick="resetHomePage()"><i class="fas fa-home"></i> Home</button>
        </div>
        
        <!-- Dropdowns and Controls -->
        <div class="dropdown">
            <button class="dropbtn" onclick="toggleDropdown('tools-dropdown')"><i class="fas fa-tools"></i> Ships & Tools</button>
            <div id="tools-dropdown" class="dropdown-content">
                <a href="#" onclick="showIframe('iframe1')"><i class="fas fa-shuttle-space"></i> Ship Builder</a>
                <a href="#" onclick="showIframe('iframe2')"><i class="fas fa-search"></i> Item Finder</a>
                <a href="#" onclick="showIframe('iframe5')"><i class="fas fa-skull"></i> SnarePlan</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn" onclick="toggleDropdown('trading-dropdown')"><i class="fas fa-exchange-alt"></i> Trading</button>
            <div id="trading-dropdown" class="dropdown-content">
                <a href="#" onclick="showIframe('iframe3')"><i class="fas fa-exchange-alt"></i> Trading (UEX)</a>
                <a href="#" onclick="showIframe('gallog')"><i class="fas fa-exchange-alt"></i> Trading (Gallog)</a>
                <a href="#" onclick="showIframe('iframe4')"><i class="fas fa-industry"></i> Mining (Regolith)</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn" onclick="toggleDropdown('exploration-dropdown')"><i class="fas fa-globe"></i> Exploration</button>
            <div id="exploration-dropdown" class="dropdown-content">
                <a href="#" onclick="showIframe('verseguide')"><i class="fas fa-moon"></i> Verseguide</a>
                <a href="#" onclick="showIframe('arkmap')"><i class="fas fa-map"></i> Planet Survey</a>
            </div>
        </div>
        
        <div class="dropdown">
            <button class="dropbtn" onclick="showIframe('radio')"><i class="fas fa-radio"></i> Internet Radio</button>
        </div>
        <button class="settings-btn" title="Customize" onclick="toggleSettingsPanel()"><i class="fas fa-cog"></i></button>
        <div class="controls">
            <button data-tooltip="Minimize" class="minimize" onclick="minimizeWindow()"><i class="fas fa-minus-square"></i></button>
            <button data-tooltip="Maximize" class="maximize" onclick="toggleMaximizeWindow()"><i class="fas fa-window-restore"></i></button>
            <button data-tooltip="Close" class="close" onclick="closeWindow()"><i class="fas fa-times-rectangle"></i></button>
        </div>
    </div>
    <div id="iframe-container">
        <iframe id="homepage" src="indexnew.html"></iframe>
        <iframe id="iframe1" src="https://www.erkul.games"></iframe>
        <iframe id="iframe2" src="https://finder.cstone.space"></iframe>
        <iframe id="iframe3" src="https://uexcorp.space/"></iframe>
        <iframe id="verseguide" src="https://verseguide.com"></iframe>
        <iframe id="gallog" src="https://gallog.co"></iframe>
        <iframe id="arkmap" src="https://survey.cstone.space/"></iframe>
        <iframe id="iframe4" src="https://regolith.rocks"></iframe>
        <iframe id="radio" src="radio_browser.html"></iframe>
        <iframe id="radio_new" src="radio_browser.html"></iframe>
        <iframe id="iframe5" src="https://snareplan.dolus.eu"></iframe>
    </div>
    <!-- Include renderer.js -->
    <script src="renderer.js"></script>
    <script>
        const skinSettings = {
            "default": {
                "navbar-bg": "linear-gradient(135deg, #1e1e1e, #444)",
                "button-bg": "#333",
                "button-hover": "#555",
                "background-color": "#2e2e2e",
                "text-color": "#fff",
                "background-image": ""
            },
            "light": {
                "navbar-bg": "#f0f0f0",
                "button-bg": "#ccc",
                "button-hover": "#bbb",
                "background-color": "#ffffff",
                "text-color": "#000000",
                "background-image": ""
            }
        };
        function toggleDropdown(id) {
            document.getElementById(id).classList.toggle('active');
        }
        function showIframe(id) {
            document.querySelectorAll('iframe').forEach(iframe => iframe.classList.remove('active'));
            const iframe = document.getElementById(id);
            if (iframe) {
                iframe.classList.add('active');
            }
        }
        function toggleSettingsPanel() {
            const panel = document.getElementById('settings-panel');
            const overlay = document.getElementById('overlay');
            const isVisible = panel.style.display === 'block';
            panel.style.display = isVisible ? 'none' : 'block';
            overlay.style.display = isVisible ? 'none' : 'block';
        }
        function applySkin(skin) {
            var settings = skinSettings[skin];
            if (settings) {
                document.documentElement.style.setProperty('--navbar-bg', settings["navbar-bg"]);
                document.documentElement.style.setProperty('--button-bg', settings["button-bg"]);
                document.documentElement.style.setProperty('--button-hover', settings["button-hover"]);
                document.documentElement.style.setProperty('--background-color', settings["background-color"]);
                document.documentElement.style.setProperty('--text-color', settings["text-color"]);
                if (settings["background-image"]) {
                    document.body.style.backgroundImage = `url(${settings["background-image"]})`;
                    document.body.classList.add("with-background");
                } else {
                    document.body.style.backgroundImage = "";
                    document.body.classList.remove("with-background");
                }
                localStorage.setItem('skin', skin);
            }
        }
        function setDefaultPage(pageId) {
            localStorage.setItem('defaultPage', pageId);
            showIframe(pageId);
        }
        function resetHomePage() {
            const homepageIframe = document.getElementById('homepage');
            if (homepageIframe) {
                homepageIframe.src = 'indexnew.html'; // Ensure it reloads
            }
            showIframe('homepage');
        }
        window.onload = function() {
            console.log('Page loaded'); // Debug log
            const savedSkin = localStorage.getItem('skin');
            const savedPage = localStorage.getItem('defaultPage');
            if (savedSkin) {
                applySkin(savedSkin); // Apply saved skin settings
            }
            setTimeout(() => {
                if (savedPage) {
                    console.log(`Loading saved page: ${savedPage}`); // Debug log
                    showIframe(savedPage); // Show saved default page
                } else {
                    console.log('No saved page, defaulting to homepage'); // Debug log
                    showIframe('homepage'); // Default to homepage if no saved page
                }
            }, 100); // Delay to ensure iframes are loaded
            //checkForUpdates(); // Check for updates on load
        }
    </script>
</body>
</html>